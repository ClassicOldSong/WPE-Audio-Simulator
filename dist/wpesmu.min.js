!function(){"use strict";function t(t,n){return n={exports:{}},t(n,n.exports),n.exports}function n(t){return t<0||t===1/0?0:t}function e(t){var n=URL.createObjectURL(t.target.files[0]);oe.src&&URL.revokeObjectURL(oe.src),oe.src=n}function r(){se||be(),oe.play()}function o(){oe.pause()}function i(){oe.pause(),oe.currentTime=0,window.cancelAnimationFrame(se),se=0}var u="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},c=Math.ceil,a=Math.floor,f=function(t){return isNaN(t=+t)?0:(t>0?a:c)(t)},l=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},s=f,d=l,p=t(function(t){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)}),v=t(function(t){var n=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)}),y=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},h=y,w=function(t,n,e){if(h(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)}}return function(){return t.apply(n,arguments)}},g=function(t){return"object"==typeof t?null!==t:"function"==typeof t},m=g,b=function(t){if(!m(t))throw TypeError(t+" is not an object!");return t},S=function(t){try{return!!t()}catch(t){return!0}},O=!S(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),E=g,A=p.document,C=E(A)&&E(A.createElement),_=function(t){return C?A.createElement(t):{}},L=!O&&!S(function(){return 7!=Object.defineProperty(_("div"),"a",{get:function(){return 7}}).a}),M=g,j=function(t,n){if(!M(t))return t;var e,r;if(n&&"function"==typeof(e=t.toString)&&!M(r=e.call(t)))return r;if("function"==typeof(e=t.valueOf)&&!M(r=e.call(t)))return r;if(!n&&"function"==typeof(e=t.toString)&&!M(r=e.call(t)))return r;throw TypeError("Can't convert object to primitive value")},x=b,F=L,P=j,T=Object.defineProperty,R=O?Object.defineProperty:function(t,n,e){if(x(t),n=P(n,!0),x(e),F)try{return T(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t},U={f:R},I=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}},k=U,D=I,N=O?function(t,n,e){return k.f(t,n,D(1,e))}:function(t,n,e){return t[n]=e,t},W=p,B=v,q=w,z=N,G=function(t,n,e){var r,o,i,u=t&G.F,c=t&G.G,a=t&G.S,f=t&G.P,l=t&G.B,s=t&G.W,d=c?B:B[n]||(B[n]={}),p=d.prototype,v=c?W:a?W[n]:(W[n]||{}).prototype;c&&(e=n);for(r in e)(o=!u&&v&&void 0!==v[r])&&r in d||(i=o?v[r]:e[r],d[r]=c&&"function"!=typeof v[r]?e[r]:l&&o?q(i,W):s&&v[r]==i?function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n.prototype=t.prototype,n}(i):f&&"function"==typeof i?q(Function.call,i):i,f&&((d.virtual||(d.virtual={}))[r]=i,t&G.R&&p&&!p[r]&&z(p,r,i)))};G.F=1,G.G=2,G.S=4,G.P=8,G.B=16,G.W=32,G.U=64,G.R=128;var Y=G,H=N,J={}.hasOwnProperty,K=function(t,n){return J.call(t,n)},Q={},V={}.toString,X=function(t){return V.call(t).slice(8,-1)},Z=X,$=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==Z(t)?t.split(""):Object(t)},tt=$,nt=l,et=function(t){return tt(nt(t))},rt=f,ot=Math.min,it=function(t){return t>0?ot(rt(t),9007199254740991):0},ut=f,ct=Math.max,at=Math.min,ft=function(t,n){return t=ut(t),t<0?ct(t+n,0):at(t,n)},lt=et,st=it,dt=ft,pt=p,vt=pt["__core-js_shared__"]||(pt["__core-js_shared__"]={}),yt=function(t){return vt[t]||(vt[t]={})},ht=0,wt=Math.random(),gt=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++ht+wt).toString(36))},mt=yt("keys"),bt=gt,St=function(t){return mt[t]||(mt[t]=bt(t))},Ot=K,Et=et,At=function(t){return function(n,e,r){var o,i=lt(n),u=st(i.length),c=dt(r,u);if(t&&e!=e){for(;u>c;)if((o=i[c++])!=o)return!0}else for(;u>c;c++)if((t||c in i)&&i[c]===e)return t||c||0;return!t&&-1}}(!1),Ct=St("IE_PROTO"),_t=function(t,n){var e,r=Et(t),o=0,i=[];for(e in r)e!=Ct&&Ot(r,e)&&i.push(e);for(;n.length>o;)Ot(r,e=n[o++])&&(~At(i,e)||i.push(e));return i},Lt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Mt=_t,jt=Lt,xt=Object.keys||function(t){return Mt(t,jt)},Ft=U,Pt=b,Tt=xt,Rt=O?Object.defineProperties:function(t,n){Pt(t);for(var e,r=Tt(n),o=r.length,i=0;o>i;)Ft.f(t,e=r[i++],n[e]);return t},Ut=p.document&&document.documentElement,It=b,kt=Rt,Dt=Lt,Nt=St("IE_PROTO"),Wt=function(){},Bt=function(){var t,n=_("iframe"),e=Dt.length;for(n.style.display="none",Ut.appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),Bt=t.F;e--;)delete Bt.prototype[Dt[e]];return Bt()},qt=Object.create||function(t,n){var e;return null!==t?(Wt.prototype=It(t),e=new Wt,Wt.prototype=null,e[Nt]=t):e=Bt(),void 0===n?e:kt(e,n)},zt=t(function(t){var n=yt("wks"),e=gt,r=p.Symbol,o="function"==typeof r;(t.exports=function(t){return n[t]||(n[t]=o&&r[t]||(o?r:e)("Symbol."+t))}).store=n}),Gt=U.f,Yt=K,Ht=zt("toStringTag"),Jt=function(t,n,e){t&&!Yt(t=e?t:t.prototype,Ht)&&Gt(t,Ht,{configurable:!0,value:n})},Kt=qt,Qt=I,Vt=Jt,Xt={};N(Xt,zt("iterator"),function(){return this});var Zt=function(t,n,e){t.prototype=Kt(Xt,{next:Qt(1,e)}),Vt(t,n+" Iterator")},$t=l,tn=function(t){return Object($t(t))},nn=K,en=tn,rn=St("IE_PROTO"),on=Object.prototype,un=Object.getPrototypeOf||function(t){return t=en(t),nn(t,rn)?t[rn]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?on:null},cn=Y,an=H,fn=N,ln=Q,sn=Zt,dn=Jt,pn=un,vn=zt("iterator"),yn=!([].keys&&"next"in[].keys()),hn=function(){return this},wn=function(t){return function(n,e){var r,o,i=String(d(n)),u=s(e),c=i.length;return u<0||u>=c?t?"":void 0:(r=i.charCodeAt(u),r<55296||r>56319||u+1===c||(o=i.charCodeAt(u+1))<56320||o>57343?t?i.charAt(u):r:t?i.slice(u,u+2):o-56320+(r-55296<<10)+65536)}}(!0);!function(t,n,e,r,o,i,u){sn(e,n,r);var c,a,f,l=function(t){if(!yn&&t in v)return v[t];switch(t){case"keys":case"values":return function(){return new e(this,t)}}return function(){return new e(this,t)}},s=n+" Iterator",d="values"==o,p=!1,v=t.prototype,y=v[vn]||v["@@iterator"]||o&&v[o],h=y||l(o),w=o?d?l("entries"):h:void 0,g="Array"==n?v.entries||y:y;if(g&&(f=pn(g.call(new t)))!==Object.prototype&&dn(f,s,!0),d&&y&&"values"!==y.name&&(p=!0,h=function(){return y.call(this)}),u&&(yn||p||!v[vn])&&fn(v,vn,h),ln[n]=h,ln[s]=hn,o)if(c={values:d?h:l("values"),keys:i?h:l("keys"),entries:w},u)for(a in c)a in v||an(v,a,c[a]);else cn(cn.P+cn.F*(yn||p),n,c)}(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,e=this._i;return e>=n.length?{value:void 0,done:!0}:(t=wn(n,e),this._i+=t.length,{value:t,done:!1})});var gn=b,mn=function(t,n,e,r){try{return r?n(gn(e)[0],e[1]):n(e)}catch(n){var o=t.return;throw void 0!==o&&gn(o.call(t)),n}},bn=Q,Sn=zt("iterator"),On=Array.prototype,En=function(t){return void 0!==t&&(bn.Array===t||On[Sn]===t)},An=U,Cn=I,_n=function(t,n,e){n in t?An.f(t,n,Cn(0,e)):t[n]=e},Ln=X,Mn=zt("toStringTag"),jn="Arguments"==Ln(function(){return arguments}()),xn=function(t,n){try{return t[n]}catch(t){}},Fn=function(t){var n,e,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=xn(n=Object(t),Mn))?e:jn?Ln(n):"Object"==(r=Ln(n))&&"function"==typeof n.callee?"Arguments":r},Pn=Fn,Tn=zt("iterator"),Rn=Q,Un=v.getIteratorMethod=function(t){if(void 0!=t)return t[Tn]||t["@@iterator"]||Rn[Pn(t)]},In=zt("iterator"),kn=!1;try{var Dn=[7][In]();Dn.return=function(){kn=!0},Array.from(Dn,function(){throw 2})}catch(t){}var Nn=w,Wn=Y,Bn=tn,qn=mn,zn=En,Gn=it,Yn=_n,Hn=Un;Wn(Wn.S+Wn.F*!function(t,n){if(!n&&!kn)return!1;var e=!1;try{var r=[7],o=r[In]();o.next=function(){return{done:e=!0}},r[In]=function(){return o},t(r)}catch(t){}return e}(function(t){Array.from(t)}),"Array",{from:function(t){var n,e,r,o,i=Bn(t),u="function"==typeof this?this:Array,c=arguments.length,a=c>1?arguments[1]:void 0,f=void 0!==a,l=0,s=Hn(i);if(f&&(a=Nn(a,c>2?arguments[2]:void 0,2)),void 0==s||u==Array&&zn(s))for(n=Gn(i.length),e=new u(n);n>l;l++)Yn(e,l,f?a(i[l],l):i[l]);else for(o=s.call(i),e=new u;!(r=o.next()).done;l++)Yn(e,l,f?qn(o,a,[r.value,l],!0):r.value);return e.length=l,e}});var Jn=v.Array.from,Kn=t(function(t){t.exports={default:Jn,__esModule:!0}}),Qn=function(t){return t&&t.__esModule?t.default:t}(Kn),Vn=t(function(t){!function(n,e){"function"==typeof define&&define.amd?define(e):"object"==typeof t&&t.exports?t.exports=e():n.log=e()}(u,function(){function t(t){return typeof console!==c&&(void 0!==console[t]?n(console,t):void 0!==console.log?n(console,"log"):u)}function n(t,n){var e=t[n];if("function"==typeof e.bind)return e.bind(t);try{return Function.prototype.bind.call(e,t)}catch(n){return function(){return Function.prototype.apply.apply(e,[t,arguments])}}}function e(t,n,e){return function(){typeof console!==c&&(r.call(this,n,e),this[t].apply(this,arguments))}}function r(t,n){for(var e=0;e<a.length;e++){var r=a[e];this[r]=e<t?u:this.methodFactory(r,t,n)}}function o(n,r,o){return t(n)||e.apply(this,arguments)}function i(t,n,e){function i(t){var n=(a[t]||"silent").toUpperCase();try{return void(window.localStorage[s]=n)}catch(t){}try{window.document.cookie=encodeURIComponent(s)+"="+n+";"}catch(t){}}function u(){var t;try{t=window.localStorage[s]}catch(t){}if(typeof t===c)try{var n=window.document.cookie,e=n.indexOf(encodeURIComponent(s)+"=");e&&(t=/^([^;]+)/.exec(n.slice(e))[1])}catch(t){}return void 0===l.levels[t]&&(t=void 0),t}var f,l=this,s="loglevel";t&&(s+=":"+t),l.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},l.methodFactory=e||o,l.getLevel=function(){return f},l.setLevel=function(n,e){if("string"==typeof n&&void 0!==l.levels[n.toUpperCase()]&&(n=l.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=l.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(f=n,!1!==e&&i(n),r.call(l,n,t),typeof console===c&&n<l.levels.SILENT)return"No console available for logging"},l.setDefaultLevel=function(t){u()||l.setLevel(t,!1)},l.enableAll=function(t){l.setLevel(l.levels.TRACE,t)},l.disableAll=function(t){l.setLevel(l.levels.SILENT,t)};var d=u();null==d&&(d=null==n?"WARN":n),l.setLevel(d,!1)}var u=function(){},c="undefined",a=["trace","debug","info","warn","error"],f=new i,l={};f.getLogger=function(t){if("string"!=typeof t||""===t)throw new TypeError("You must supply a name when creating a logger.");var n=l[t];return n||(n=l[t]=new i(t,f.getLevel(),f.methodFactory)),n};var s=typeof window!==c?window.log:void 0;return f.noConflict=function(){return typeof window!==c&&window.log===f&&(window.log=s),f},f})}),Xn=console.log.bind(null,"[WPESMU]"),Zn=(Vn.trace.bind(null,"[WPESMU]"),Vn.debug.bind(null,"[WPESMU]"),Vn.info.bind(null,"[WPESMU]"));Vn.warn.bind(null,"[WPESMU]"),Vn.error.bind(null,"[WPESMU]");Vn.setLevel("trace"),Zn("Debug logging enabled!");!function(t,n){if("undefined"==typeof document)return n;t=t||"";var e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t)),e.appendChild(r)}(".wsmu.box {\n\tposition: fixed;\n\tpadding: 5px;\n\toverflow: hidden;\n\tbackground-color: rgba(0, 0, 0, 0.6);\n\tz-index: 999999;\n\twidth: 420px;\n}\n.wsmu.top {\n\ttop: 0;\n}\n.wsmu.left {\n\tleft: 0;\n}\n.wsmu.bottom {\n\tbottom: 0;\n}\n.wsmu.right {\n\tright: 0;\n}\n.wsmu.canvas {\n\twidth: 100%;\n\theight: 200px;\n}\n",void 0);var $n=function(t){return document.querySelector(t)},te=null,ne=null,ee=function(t){return Xn("Data received!",t)},re=function(t){ee=t};window.wallpaperRegisterAudioListener=re;var oe=new Audio,ie=new AudioContext,ue=ie.createMediaElementSource(oe),ce=ie.createScriptProcessor(4096),ae=ie.createChannelSplitter(),fe=ie.createAnalyser(),le=ie.createAnalyser(),se=0,de=0,pe=0,ve=!1,ye=[new Float32Array(4096),new Float32Array(4096)];fe.smoothingTimeConstant=0,le.smoothingTimeConstant=0,fe.fftSize=2048,le.fftSize=2048;var he=function(t){for(var n=t.inputBuffer,e=t.outputBuffer,r=0;r<e.numberOfChannels;r++){var o=n.getChannelData(r),i=e.getChannelData(r);e.copyToChannel(ye[r],r);for(var u=0;u<n.length;u++)i[u]+=o[u]}},we=function(t){for(var n=t.inputBuffer,e=0;e<n.numberOfChannels;e++)n.copyFromChannel(ye[e],e)};ce.onaudioprocess=he;var ge=function(){var t=ne.getImageData(0,0,te.width,te.height);te.width=te.width,ne.putImageData(t,-1,0)},me=function(t,n){return t+n},be=function t(){se=window.requestAnimationFrame(t);var e=performance.now(),r=e-de;if(de=e,!((pe+=r)<=1e3/30)){pe=0;var o=new Float32Array(fe.frequencyBinCount),i=new Float32Array(le.frequencyBinCount);fe.getFloatFrequencyData(o),le.getFloatFrequencyData(i);for(var u=Qn(o).slice(0,512),c=Qn(i).slice(0,512),a=[],f=[],l=0;l<512;l+=8)a.push(Math.pow(u.slice(l,l+8).reduce(me)/1024+1,2)*Math.pow(.9+4*l/o.length,2)*.6),f.push(Math.pow(c.slice(l,l+8).reduce(me)/1024+1,2)*Math.pow(.9+4*l/i.length,2)*.6);var s=c.concat(u).reverse();ge();for(var d in s){var p=(128+s[d])/128;p<0&&(p=0),ne.fillStyle="rgba(255, 255, 255, "+p+")",ne.fillRect(1023,d,1,1)}var v=a.reverse().concat(f.reverse()).map(n);ee(v)}},Se=function t(){document.removeEventListener("DOMContentLoaded",t,!1),$n("body").insertAdjacentHTML("afterbegin",'<div class="wsmu box left top">\n\t<input class="wsmu input" type="file" accept="audio/*">\n\t<button class="wsmu btn play">Play</button>\n\t<button class="wsmu btn pause">Pause</button>\n\t<button class="wsmu btn stop">Stop</button>\n\t<canvas class="wsmu canvas" height="1024" width="1024"></canvas>\n</div>\n');var n=$n(".wsmu.input"),u=$n(".wsmu.btn.play"),c=$n(".wsmu.btn.pause"),a=$n(".wsmu.btn.stop");te=$n(".wsmu.canvas"),ne=te.getContext("2d"),ve&&be(),n.addEventListener("change",e),u.addEventListener("click",r),c.addEventListener("click",o),a.addEventListener("click",i),Zn("v0.3.1.master.a7f0d83 Initialized!")},Oe=function(){ue.connect(ce),ce.connect(ae),ae.connect(fe,0,0),ae.connect(le,1,0),ue.connect(ie.destination),Se(),be()},Ee=function(t){var n=new AudioContext,e=n.createScriptProcessor(4096),r=n.createMediaStreamSource(t);e.onaudioprocess=we,r.connect(e),e.connect(n.destination),ve=!0},Ae=function(t){return Xn("Rejected!",t)},Ce=function(){if(navigator.mediaDevices)navigator.mediaDevices.getUserMedia({audio:!0}).then(Ee).catch(Ae);else try{navigator.getUserMedia({audio:!0},Ee,Ae)}catch(t){Xn("Your browser doesn't support audio recording!",t)}Oe()};document.addEventListener("DOMContentLoaded",Ce,!1)}();
